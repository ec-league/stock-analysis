insert into STOCK_DAILY_WIDE_DIGEST (CODE, NAME, START_PRICE, L1D_START_PRICE, L2D_START_PRICE, L3D_START_PRICE,
                                     L4D_START_PRICE, L5D_START_PRICE, L6D_START_PRICE, L7D_START_PRICE,
                                     L8D_START_PRICE, L9D_START_PRICE, L10D_START_PRICE, L11D_START_PRICE,
                                     L12D_START_PRICE, L13D_START_PRICE, L14D_START_PRICE, L15D_START_PRICE,
                                     L16D_START_PRICE, L17D_START_PRICE, L18D_START_PRICE, L19D_START_PRICE,
                                     L20D_START_PRICE, L21D_START_PRICE, L22D_START_PRICE, L23D_START_PRICE,
                                     L24D_START_PRICE, L25D_START_PRICE, L26D_START_PRICE, L27D_START_PRICE,
                                     L28D_START_PRICE, L29D_START_PRICE, L30D_START_PRICE, END_PRICE, L1D_END_PRICE,
                                     L2D_END_PRICE, L3D_END_PRICE, L4D_END_PRICE, L5D_END_PRICE, L6D_END_PRICE,
                                     L7D_END_PRICE, L8D_END_PRICE, L9D_END_PRICE, L10D_END_PRICE, L11D_END_PRICE,
                                     L12D_END_PRICE, L13D_END_PRICE, L14D_END_PRICE, L15D_END_PRICE, L16D_END_PRICE,
                                     L17D_END_PRICE, L18D_END_PRICE, L19D_END_PRICE, L20D_END_PRICE, L21D_END_PRICE,
                                     L22D_END_PRICE, L23D_END_PRICE, L24D_END_PRICE, L25D_END_PRICE, L26D_END_PRICE,
                                     L27D_END_PRICE, L28D_END_PRICE, L29D_END_PRICE, L30D_END_PRICE, HIGHEST_PRICE,
                                     L1D_HIGHEST_PRICE, L2D_HIGHEST_PRICE, L3D_HIGHEST_PRICE, L4D_HIGHEST_PRICE,
                                     L5D_HIGHEST_PRICE, L6D_HIGHEST_PRICE, L7D_HIGHEST_PRICE, L8D_HIGHEST_PRICE,
                                     L9D_HIGHEST_PRICE, L10D_HIGHEST_PRICE, L11D_HIGHEST_PRICE, L12D_HIGHEST_PRICE,
                                     L13D_HIGHEST_PRICE, L14D_HIGHEST_PRICE, L15D_HIGHEST_PRICE, L16D_HIGHEST_PRICE,
                                     L17D_HIGHEST_PRICE, L18D_HIGHEST_PRICE, L19D_HIGHEST_PRICE, L20D_HIGHEST_PRICE,
                                     L21D_HIGHEST_PRICE, L22D_HIGHEST_PRICE, L23D_HIGHEST_PRICE, L24D_HIGHEST_PRICE,
                                     L25D_HIGHEST_PRICE, L26D_HIGHEST_PRICE, L27D_HIGHEST_PRICE, L28D_HIGHEST_PRICE,
                                     L29D_HIGHEST_PRICE, L30D_HIGHEST_PRICE, LOWEST_PRICE, L1D_LOWEST_PRICE,
                                     L2D_LOWEST_PRICE, L3D_LOWEST_PRICE, L4D_LOWEST_PRICE, L5D_LOWEST_PRICE,
                                     L6D_LOWEST_PRICE, L7D_LOWEST_PRICE, L8D_LOWEST_PRICE, L9D_LOWEST_PRICE,
                                     L10D_LOWEST_PRICE, L11D_LOWEST_PRICE, L12D_LOWEST_PRICE, L13D_LOWEST_PRICE,
                                     L14D_LOWEST_PRICE, L15D_LOWEST_PRICE, L16D_LOWEST_PRICE, L17D_LOWEST_PRICE,
                                     L18D_LOWEST_PRICE, L19D_LOWEST_PRICE, L20D_LOWEST_PRICE, L21D_LOWEST_PRICE,
                                     L22D_LOWEST_PRICE, L23D_LOWEST_PRICE, L24D_LOWEST_PRICE, L25D_LOWEST_PRICE,
                                     L26D_LOWEST_PRICE, L27D_LOWEST_PRICE, L28D_LOWEST_PRICE, L29D_LOWEST_PRICE,
                                     L30D_LOWEST_PRICE, PARTITION_DATE, TRADING_VOLUME, BUSINESS_VOLUME, TURNOVER_RATE,
                                     PE, PB, TOTAL_VALUE, CIRCULATION_MARKET_VALUE)
select b.CODE,
       b.NAME,
       b.START_PRICE,
       b.START_PRICE   as L1D_START_PRICE,
       b.START_PRICE   as L2D_START_PRICE,
       b.START_PRICE   as L3D_START_PRICE,
       b.START_PRICE   as L4D_START_PRICE,
       b.START_PRICE   as L5D_START_PRICE,
       b.START_PRICE   as L6D_START_PRICE,
       b.START_PRICE   as L7D_START_PRICE,
       b.START_PRICE   as L8D_START_PRICE,
       b.START_PRICE   as L9D_START_PRICE,
       b.START_PRICE   as L10D_START_PRICE,
       b.START_PRICE   as L11D_START_PRICE,
       b.START_PRICE   as L12D_START_PRICE,
       b.START_PRICE   as L13D_START_PRICE,
       b.START_PRICE   as L14D_START_PRICE,
       b.START_PRICE   as L15D_START_PRICE,
       b.START_PRICE   as L16D_START_PRICE,
       b.START_PRICE   as L17D_START_PRICE,
       b.START_PRICE   as L18D_START_PRICE,
       b.START_PRICE   as L19D_START_PRICE,
       b.START_PRICE   as L20D_START_PRICE,
       b.START_PRICE   as L21D_START_PRICE,
       b.START_PRICE   as L22D_START_PRICE,
       b.START_PRICE   as L23D_START_PRICE,
       b.START_PRICE   as L24D_START_PRICE,
       b.START_PRICE   as L25D_START_PRICE,
       b.START_PRICE   as L26D_START_PRICE,
       b.START_PRICE   as L27D_START_PRICE,
       b.START_PRICE   as L28D_START_PRICE,
       b.START_PRICE   as L29D_START_PRICE,
       b.START_PRICE   as L30D_START_PRICE,
       b.END_PRICE,
       b.END_PRICE     as L1D_END_PRICE,
       b.END_PRICE     as L2D_END_PRICE,
       b.END_PRICE     as L3D_END_PRICE,
       b.END_PRICE     as L4D_END_PRICE,
       b.END_PRICE     as L5D_END_PRICE,
       b.END_PRICE     as L6D_END_PRICE,
       b.END_PRICE     as L7D_END_PRICE,
       b.END_PRICE     as L8D_END_PRICE,
       b.END_PRICE     as L9D_END_PRICE,
       b.END_PRICE     as L10D_END_PRICE,
       b.END_PRICE     as L11D_END_PRICE,
       b.END_PRICE     as L12D_END_PRICE,
       b.END_PRICE     as L13D_END_PRICE,
       b.END_PRICE     as L14D_END_PRICE,
       b.END_PRICE     as L15D_END_PRICE,
       b.END_PRICE     as L16D_END_PRICE,
       b.END_PRICE     as L17D_END_PRICE,
       b.END_PRICE     as L18D_END_PRICE,
       b.END_PRICE     as L19D_END_PRICE,
       b.END_PRICE     as L20D_END_PRICE,
       b.END_PRICE     as L21D_END_PRICE,
       b.END_PRICE     as L22D_END_PRICE,
       b.END_PRICE     as L23D_END_PRICE,
       b.END_PRICE     as L24D_END_PRICE,
       b.END_PRICE     as L25D_END_PRICE,
       b.END_PRICE     as L26D_END_PRICE,
       b.END_PRICE     as L27D_END_PRICE,
       b.END_PRICE     as L28D_END_PRICE,
       b.END_PRICE     as L29D_END_PRICE,
       b.END_PRICE     as L30D_END_PRICE,
       b.HIGHEST_PRICE,
       b.HIGHEST_PRICE as L1D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L2D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L3D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L4D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L5D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L6D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L7D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L8D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L9D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L10D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L11D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L12D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L13D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L14D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L15D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L16D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L17D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L18D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L19D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L20D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L21D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L22D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L23D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L24D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L25D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L26D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L27D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L28D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L29D_HIGHEST_PRICE,
       b.HIGHEST_PRICE as L30D_HIGHEST_PRICE,
       b.LOWEST_PRICE,
       b.LOWEST_PRICE  as L1D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L2D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L3D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L4D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L5D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L6D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L7D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L8D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L9D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L10D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L11D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L12D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L13D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L14D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L15D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L16D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L17D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L18D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L19D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L20D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L21D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L22D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L23D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L24D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L25D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L26D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L27D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L28D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L29D_LOWEST_PRICE,
       b.LOWEST_PRICE  as L30D_LOWEST_PRICE,
       b.PARTITION_DATE,
       b.TRADING_VOLUME,
       b.BUSINESS_VOLUME,
       b.TURNOVER_RATE,
       b.PE,
       b.PB,
       b.TOTAL_VALUE,
       b.CIRCULATION_MARKET_VALUE
FROM (select CODE, min(PARTITION_DATE) as PARTITION_DATE
      from STOCK_DAILY_DIGEST
      group by CODE) a
         left join STOCK_DAILY_DIGEST b
                   on a.CODE = b.CODE and a.PARTITION_DATE = b.PARTITION_DATE;